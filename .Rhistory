aes(x = Year, Living.Planet.Index, color=Entity)) +
geom_point() +
geom_text(data = labels,
aes(label = label_wrapped),
hjust = -0.1,
size = 4) +
expand_limits(x = 2038) +
theme_dark() +
theme(legend.position = 'none')
ggplot(living_index %>%
group_by(Entity),
aes(x = Year, Living.Planet.Index, color=Entity)) +
geom_point() +
geom_text(data = labels,
aes(label = label_wrapped),
hjust = -0.1,
size = 4) +
expand_limits(x = 2038) +
theme_gray() +
theme(legend.position = 'none')
ggplot(living_index %>%
group_by(Entity),
aes(x = Year, Living.Planet.Index, color=Entity)) +
geom_point() +
geom_text(data = labels,
aes(label = label_wrapped),
hjust = -0.1,
size = 4) +
expand_limits(x = 2038) +
theme_linedraw() +
theme(legend.position = 'none')
ggplot(living_index %>%
group_by(Entity),
aes(x = Year, Living.Planet.Index, color=Entity)) +
geom_point() +
geom_text(data = labels,
aes(label = label_wrapped),
hjust = -0.1,
size = 4) +
expand_limits(x = 2035) +
theme_linedraw() +
theme(legend.position = 'none')
ggplot(living_index %>%
group_by(Entity),
aes(x = Year, Living.Planet.Index, color=Entity)) +
geom_point() +
geom_text(data = labels,
aes(label = label_wrapped),
hjust = -0.1,
size = 5) +
expand_limits(x = 2035) +
theme_linedraw() +
theme(legend.position = 'none')
View(living_index)
unique(living_index$Code)
living_index <- living_index %>%
mutate(continent = case_when(
(Entity == "Africa") ~ "Africa",
(Entity == "Asia and Pacific") ~ "Asia",
(Entity == "Europe and Central Asia") ~ "Europe",
(Entity == "Latin America and the Caribbean") ~ "South America",
(Entity == "North America") ~ "North America",
))
forest_area <- read.csv("data/annual-change-forest-area/annual-change-forest-area.csv")
c.c <- read.csv("data/countries_continents.csv")
View(c.c)
View(forest_area)
View(forest_loss)
ggplot(forest_area %>%
group_by(Code),
aes(x = Year, y = Annual.net.change.in.forest.area))  +
geom_point()
View(living_index)
ggplot(forest_area %>%
group_by(Code),
aes(x = Year, y = Annual.net.change.in.forest.area))  +
geom_line()
ggplot(forest_area,
aes(x = Year, y = Annual.net.change.in.forest.area))  +
geom_line() +
facet_wrap(~ Code, scales = "free_y") + theme_minimal()
library(countrycode)
install.packages("countrycode")
library(countrycode)
??countrycode
forest_area <- forest_area %>%
mutate(
Continent = countrycode(Code, origin = "iso3c", destination = "continent")
)
forest_area <- forest_area %>%
filter(!is.na(Continent))
library(ggplot2)
library(dbplyr)
library(tidyverse)
library(rnaturalearth)
library(sf)
library(rmapshaper)
library(countrycode)
# to be joined
forest_area <- read.csv("data/annual-change-forest-area/annual-change-forest-area.csv")
forest_area <- forest_area %>%
mutate(
Continent = countrycode(Code, origin = "iso3c", destination = "continent")
)
labels <- living_index %>%
group_by(Entity) %>%
filter(Year == max(Year)) %>%
mutate(label_wrapped = str_trunc(Entity, width = 15, side = "right"))
ggplot(living_index %>%
group_by(Entity),
aes(x = Year, Living.Planet.Index, color=Entity)) +
geom_point() +
geom_text(data = labels,
aes(label = label_wrapped),
hjust = -0.1,
size = 5) +
expand_limits(x = 2035) +
theme_linedraw() +
theme(legend.position = 'none') +
labs(title = "How has the Living Planet Index changed on every ")
ggplot(forest_area,
aes(x = Year, y = Annual.net.change.in.forest.area))  +
geom_line() +
facet_wrap(~ Continent, scales = "free_y") + theme_minimal()
ggplot(living_index %>%
group_by(Entity),
aes(x = Year, Living.Planet.Index, color=Entity)) +
geom_point() +
geom_text(data = labels,
aes(label = label_wrapped),
hjust = -0.1,
size = 5) +
expand_limits(x = 2035) +
theme_linedraw() +
theme(legend.position = 'none') +
labs(title = "How has the Living Planet Index changed on every ")
# visualization part 1
png("final-p1.png")
ggplot(subset_world) +
geom_sf(aes(fill = deforestation_rate), color = "white") +
scale_fill_gradient(low = "red", high = "green", limits = c(low, high)) +
theme_void() + labs(title = "How has net forest area changed over the past 20 years?",
subtitle = "Net change in Forest Area (2000-2020), filtered outliers", fill="Change %")
dev.off()
# Visualization part 2
labels <- living_index %>%
group_by(Entity) %>%
filter(Year == max(Year)) %>%
mutate(label_wrapped = str_trunc(Entity, width = 15, side = "right"))
png("final-p2.png")
ggplot(living_index %>%
group_by(Entity),
aes(x = Year, Living.Planet.Index, color=Entity)) +
geom_point() +
geom_text(data = labels,
aes(label = label_wrapped),
hjust = -0.1,
size = 5) +
expand_limits(x = 2035) +
theme_linedraw() +
theme(legend.position = 'none') +
labs(title = "How has the Living Planet Index changed in relation to deforestation?", subtitle="Living Planet Index per region (1970-2020)")
dev.off()
ggplot(forest_area,
aes(x = Year, y = Annual.net.change.in.forest.area))  +
geom_line() +
facet_wrap(~ Continent, scales = "free_y") + theme_minimal()
data <- read.csv("../../wages.csv")
y = data$height
x = data$sex
m1 = mean(y[x == "male"])
m2 = mean(y[x == "female"])
v1 = sd(y[x == "male"])^2
v2 = sd(y[x == "female"])^2
n1 = length(y[x == "male"])
n2 = length(y[x == "female"])
data <- read.csv("../../wages.csv")
data <- read.csv("../../wages.csv")
y = data$height
x = data$sex
m1 = mean(y[x == "male"])
m2 = mean(y[x == "female"])
v1 = sd(y[x == "male"])^2
v2 = sd(y[x == "female"])^2
n1 = length(y[x == "male"])
n2 = length(y[x == "female"])
diff = m1 - m2
t.star = qt(0.975, df = n1)
moe = t.star * sqrt(v1/n1 + v2/n2)
# left: 5.235
paste0(diff - moe)
# right: 5.848
paste0(diff + moe)
gc()
?pt
x1 = c(2, 1, 3)
x2 = c(6, 3, 9)
diff = x1 - x2
xbar = mean(diff)
sx = sd(diff)
n = 3
# 90% confidence
t.star = qt(0.95, n - 1)
moe = t.star * (sx/sqrt(n))
x1 = c(2, 1, 3)
x2 = c(6, 3, 9)
diff = x2 - x1
xbar = mean(diff)
sx = sd(diff)
n = 3
# 90% confidence
t.star = qt(0.95, n - 1)
moe = t.star * (sx/sqrt(n))
# difference of means
x1 = c(2, 1, 3)
x2 = c(6, 3, 9)
n1 = length(x1)
n2 = length(x2)
x1bar = mean(x1)
x2bar = mean(x2)
t.star = qt(0.95, 2.4)
v = sqrt( (sd(x1)^2/n1) + (sd(x2)^2/n2) )
moe = t.star * v
diff = (x2bar - x1bar)
# difference of means
x1 = c(2, 1, 3)
x2 = c(9,3,6)
diff = x2 - x1
xbar = mean(diff) # 4
sx = sd(diff)
n = 3
# 90% confidence
t.star = qt(0.95, n - 1)
moe = t.star * (sx/sqrt(n)) # approx 3.372
# difference of means
x1 = c(2, 1, 3)
x2 = c(9,3,6)
diff = x2 - x1
xbar = mean(diff) # 4
sx = sd(diff)
n = 3
# 90% confidence
t.star = qt(0.95, n - 1)
moe = t.star * (sx/sqrt(n)) # approx 3.372
# difference of means
x1 = c(2, 1, 3)
x2 = c(9,3,6)
n1 = length(x1)
n2 = length(x2)
x1bar = mean(x1)
x2bar = mean(x2)
t.star = qt(0.95, 2.4)
v = sqrt( (sd(x1)^2/n1) + (sd(x2)^2/n2) )
moe = t.star * v
diff = (x2bar - x1bar)
L = c(1928, 2549, 2825, 1924, 1628, 2175, 2114, 2621, 1843, 2541)
P = c(2126, 2885, 2895, 1942, 1750, 2184, 2164, 2626, 2006, 2627)
n = length(P) # same as N
d = P - L # doesn't actually matter since we are just testing for a difference
d.m = mean(d)
t.star = qt(0.975, n - 1)
moe = t.star * (sd(d)/sqrt(n))
?t.test
def_glob <- read.csv("data/goal15.forest_shares.csv")
living_index <- read.csv("data/global-living-planet-index.csv")
habitat_loss <- st_read("data/wwf_loss/wwf_ecos_hab_loss.shp")
library(ggplot2)
library(dbplyr)
library(tidyverse)
library(rnaturalearth)
library(sf)
library(rmapshaper)
library(countrycode)
def_glob <- read.csv("data/goal15.forest_shares.csv")
living_index <- read.csv("data/global-living-planet-index.csv")
habitat_loss <- st_read("data/wwf_loss/wwf_ecos_hab_loss.shp")
# 1gb, be careful
#geodata_agriculture <- st_read("data/agricultureshp/wri_agriculture_linked_deforestation_v202010.shp")
# food
food_deforestation <- read.csv("data/per-capita-co2-food-deforestation/per-capita-co2-food-deforestation.csv")
# to be joined
forest_area <- read.csv("data/annual-change-forest-area/annual-change-forest-area.csv")
c.c <- read.csv("data/countries_continents.csv")
?t.test
set.seed(1)
pop = runif(100000, 0, 2)
pop.mean = mean(pop)
pop.sd = sd(pop)
pop.median = median(pop)
n.trial = 1000
sample.size = 100
CI <- matrix(nrow = n.trial, ncol = 2)
for (i in 1:n.trial) {
sample.trial <- sample(pop, sample.size)
CI[i, ] <- t.test(sample.trial)$conf.int[1:2]
}
count <- 0
for (i in 1:n.trial) {
if (CI[i, 1] <= pop.mean && CI[i, 2] >= pop.mean) {
count = count + 1
}
}
dat = read.table("http://sites.stat.washington.edu/marzban/390/stuff/brainhead_dat.txt", header=TRUE)
gender <- dat$gender
age <- dat$age
head <- dat$head
brain <- dat$brain
par(mfrow = c(1, 2))
boxplot(head[age == 1])
dat = read.table("http://sites.stat.washington.edu/marzban/390/stuff/brainhead_dat.txt", header=TRUE)
gender <- dat$gender
age <- dat$age
head <- dat$head
brain <- dat$brain
par(mfrow = c(1, 2))
boxplot(head[age == 1])
boxplot(head[age == 2])
?boxplot
dat = read.table("http://sites.stat.washington.edu/marzban/390/stuff/brainhead_dat.txt", header=TRUE)
gender <- dat$gender
age <- dat$age
head <- dat$head
brain <- dat$brain
par(mfrow = c(1, 2))
boxplot(head[age == 1], xlab = "age young")
boxplot(head[age == 2], xlab = "age old")
?t.test
pa.young = head[age == 1]
pa.old = head[age == 2]
n.young = length(pa.young)
n.old = length(pa.old)
t.test(pa.young, pa.old, alternative = "two.sided", conf.level = 0.90)
dat = read.table("http://sites.stat.washington.edu/marzban/390/stuff/brainhead_dat.txt", header=TRUE)
gender <- dat$gender
age <- dat$age
head <- dat$head
brain <- dat$brain
par(mfrow = c(1, 2))
boxplot(head[age == 1], xlab = "age young")
boxplot(head[age == 2], xlab = "age old")
t.test(pa.young, pa.old, alternative = "greater", conf.level = 0.95)
set.seed(1)
pop = runif(100000, 0, 2)
pop.mean = mean(pop)
pop.sd = sd(pop)
pop.median = median(pop)
n.trial = 1000
sample.size = 100
CI <- matrix(nrow = n.trial, ncol = 2)
for (i in 1:n.trial) {
sample.trial <- sample(pop, sample.size)
CI[i, ] <- t.test(sample.trial)$conf.int[1:2]
}
count <- 0
for (i in 1:n.trial) {
if (CI[i, 1] <= pop.mean && CI[i, 2] >= pop.mean) {
count = count + 1
}
}
count
set.seed(1)
pop = runif(100000, 0, 2)
pop.mean = mean(pop)
pop.sd = sd(pop)
pop.median = median(pop)
t.star = pt(0.975, df = 99)
n.trial = 1000
sample.size = 100
CI <- matrix(nrow = n.trial, ncol = 2)
for (i in 1:n.trial) {
sample.trial <- sample(pop, sample.size)
CI[i, 1] <- 2 * t.test(sample.trial)$conf.int[1] / (1 - t.star /sqrt(3 * sample.size))
CI[i, 2] <- 2 * t.test(sample.trial)$conf.int[1] / (1 + t.star /sqrt(3 * sample.size))
}
count <- 0
for (i in 1:n.trial) {
if (CI[i, 1] <= 2 && CI[i, 2] >= 2) {
count = count + 1
}
}
count
pt(0.975, df = 99)
set.seed(1)
pop = runif(100000, 0, 2)
pop.mean = mean(pop)
pop.sd = sd(pop)
pop.median = median(pop)
t.star = 1 - pt(0.975, df = 99)
n.trial = 1000
sample.size = 100
CI <- matrix(nrow = n.trial, ncol = 2)
for (i in 1:n.trial) {
sample.trial <- sample(pop, sample.size)
CI[i, 1] <- 2 * t.test(sample.trial)$conf.int[1] / (1 - t.star /sqrt(3 * sample.size))
CI[i, 2] <- 2 * t.test(sample.trial)$conf.int[1] / (1 + t.star /sqrt(3 * sample.size))
}
count <- 0
for (i in 1:n.trial) {
if (CI[i, 1] <= 2 && CI[i, 2] >= 2) {
count = count + 1
}
}
count
View(CI)
set.seed(1)
pop = runif(100000, 0, 2)
pop.mean = mean(pop)
pop.sd = sd(pop)
pop.median = median(pop)
t.star = 1 - pt(0.975, df = 99)
n.trial = 1000
sample.size = 100
CI <- matrix(nrow = n.trial, ncol = 2)
for (i in 1:n.trial) {
sample.trial <- sample(pop, sample.size)
CI[i, 1] <- (2 * t.test(sample.trial)$conf.int[1]) / (1 - t.star /sqrt(3 * sample.size))
CI[i, 2] <- (2 * t.test(sample.trial)$conf.int[2]) / (1 + t.star /sqrt(3 * sample.size))
}
count <- 0
for (i in 1:n.trial) {
if (CI[i, 1] <= 2 && CI[i, 2] >= 2) {
count = count + 1
}
}
count
mean(head[age == 1])
mean(head[age == 2])
set.seed(1)
pop = runif(100000, 0, 2)
pop.mean = mean(pop)
pop.sd = sd(pop)
pop.median = median(pop)
t.star = 1 - pt(0.975, df = 99)
n.trial = 1000
sample.size = 100
CI <- matrix(nrow = n.trial, ncol = 2)
for (i in 1:n.trial) {
sample.trial <- sample(pop, sample.size)
CI[i, 1] <- (2 * t.test(sample.trial)$conf.int[1]) / (1 - t.star /sqrt(3 * sample.size))
CI[i, 2] <- (2 * t.test(sample.trial)$conf.int[2]) / (1 + t.star /sqrt(3 * sample.size))
}
count <- 0
for (i in 1:n.trial) {
if (CI[i, 1] <= 2 && CI[i, 2] >= 2) {
count = count + 1
}
}
count
pa.young = head[age == 1]
pa.old = head[age == 2]
n.young = length(pa.young)
n.old = length(pa.old)
t.test(pa.young, pa.old, alternative = "two.sided", conf.level = 0.90)
shiny::runApp('STAT451/final')
runApp('STAT451/final')
runApp('STAT451/final')
library(tidyverse)
library(leaflet)
# additional packages
library(sf)
library(rstudioapi)
library(rmapshaper)
library(plotly)
library(tidyverse)
library(leaflet)
# additional packages
library(sf)
library(rstudioapi)
library(rmapshaper)
library(plotly)
change_forest_area <- read.csv("data/annual-change-forest-area.csv")
change_forest_area <- read.csv("data/annual-change-forest-area.csv")
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
change_forest_area <- read.csv("data/annual-change-forest-area.csv")
View(change_forest_area)
length(unique(change_forest_area$Entity))
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
?labs
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
change_forest_area <- read.csv("data/annual-change-forest-area.csv")
forest_shares <- read.csv("data/archive/goal15.forest_shares.csv")
library(tidyverse)
library(leaflet)
# additional packages
library(sf)
library(rstudioapi)
library(rmapshaper)
library(plotly)
forest_long <- forest_shares %>%
pivot_longer(cols = c("forests_2000", "forests_2020"),
names_to = "time_period",
values_to = "value") %>%
mutate(highlight = (`iso3c` == "USA"))
View(forest_long)
runApp()
runApp()
runApp()
forest_shares$trend[forest_shares$iso3c == "USA"]
runApp()
View(forest_long)
View(forest_long)
runApp()
?add_annotations
runApp()
runApp()
git init
